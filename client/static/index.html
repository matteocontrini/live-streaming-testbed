<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test</title>
</head>
<body>
    <video id="player" width="600" height="300" controls>
    </video>

    <button id="play">Play</button>
    
    <script src="https://cdn.dashjs.org/latest/dash.all.debug.js"></script>

    <script>
        const url = 'https://livesim.dashif.org/livesim/testpic_2s/Manifest.mpd';
        // const url = 'https://cdn.local/manifest.mpd';
        const player = dashjs.MediaPlayer().create();
        player.initialize(document.querySelector('#player'), url);
        player.setVolume(0);
        player.updateSettings({
            streaming: {
                delay: {
                    liveDelayFragmentCount: 2
                }
            }
        })

        setInterval(() => {
            const buffer2 = player.getDashMetrics().getCurrentBufferLevel('video');
            const buffer3 = player.getDashMetrics().getCurrentBufferLevel('audio');
            const latency = player.getCurrentLiveLatency();
            console.log(`Buffer: v ${buffer2} | a ${buffer3} | L: ${latency}`);
        }, 1000);

        player.on(dashjs.MediaPlayer.events.BUFFER_EMPTY, () => {
            console.log('Buffer empty');
        });

        player.on(dashjs.MediaPlayer.events.BUFFER_LOADED, (e) => {
            console.log('Buffer loaded ' + e.mediaType);
        });

        document.getElementById('play').addEventListener('click', () => {
            console.log('Starting playback');
            player.play();
        });
    </script>

</body>
</html>
